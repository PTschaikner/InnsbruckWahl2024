<!DOCTYPE html>
<html>
<head>
    <title>Innsbruck Boundaries Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        #map { height: 600px; }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        var map = L.map('map').setView([47.2689, 11.3936], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        function getColor(winner) {
            switch (winner) {
                case 'Georg Willi - Die Innsbrucker Grünen - GRÜNE': return '#68b300'; // Example green color for this party
                // Add more cases for each party with their respective colors
                default: return '#68b300'; // Default gray color for any unmatched party
            }
        }

        // Load CSV data with D3
        d3.csv('data/ergebnis_partei.csv').then(function(data) {
            var colorMap = {};
            data.forEach(function(row) {
                colorMap[row.Sprengel_Nr] = getColor(row.Gewinner);
            });

            // Fetch the GeoJSON file and apply styles
            fetch('data/wahlspr.json')
                .then(function(response) { return response.json(); })
                .then(function(geojsonData) {
                    L.geoJSON(geojsonData, {
                        style: function (feature) {
                            var wsp = feature.properties.WSP;
                            return { color: colorMap[wsp] || '#3388ff' }; // Use color from CSV or default blue
                        }
                    }).addTo(map);
                })
                .catch(function(error) {
                    console.error('Error loading the GeoJSON data: ' + error);
                });
        });
    </script>
</body>
</html>
